<section class="container pt-3 pt-md-4 pb-3 pb-sm-4 pb-lg-5 mb-4">
    <div class="row">

        <div class="col-lg-7">
            <div class="d-flex align-items-center justify-content-between pb-2 mb-4">
                <h1 class="mb-0">Pedido</h1>
            </div>

            <hr class="border-top-0 border-bottom mb-4">

            <form [formGroup]="formPedido">
                      <h4>Entrega</h4>
                        <label class="mt-sm-1 mb-sm-4 form-label-lg" for="ch-notes">Método de envío</label>
                        <div class="form-check mb-3">
                          <input type="radio" value="Recoge en tienda" class="form-check-input" formControlName="metodoenvio">
                          <label for="courier" class="form-check-label d-flex align-items-center">
                            <span>                              
                              <strong class="d-block fs-base"><i class="ci-home me-1"></i>Recoge en tienda</strong>
                              <span class="text-muted fs-sm">Acércate a nuestro local ubicado en el Callao</span>
                            </span>
                            <span class="ms-auto fs-base">Gratis</span>
                          </label>
                        </div>
                        <div class="form-check mb-3">
                          <input type="radio" value="Contra entrega" class="form-check-input" formControlName="metodoenvio">
                          <label for="courier" class="form-check-label d-flex align-items-center">
                            <span>
                              <strong class="d-block fs-base"><i class="ci-odnoklassniki me-1"></i>Contra entrega</strong>
                              <span class="text-muted fs-sm">Centros comerciales, estaciones del metropolitano y del tren</span>
                            </span>
                            <span class="ms-auto fs-base">8 soles</span>
                          </label>
                        </div>
                        <div class="form-check mb-3">
                          <input type="radio" value="Olva courier" class="form-check-input" formControlName="metodoenvio">
                          <label for="store-pickup" class="form-check-label d-flex align-items-center">
                            <span>                              
                              <strong class="d-block fs-base"><i class="ci-truck me-1"></i>Olva courier</strong>
                              <span class="text-muted fs-sm">7-10 días</span>
                            </span>
                            <span class="ms-auto fs-base">15 soles</span>
                          </label>
                        </div>
                        <div *ngIf="formPedido.controls['metodoenvio'].hasError('required')"
                        class="text-danger mt-2">*Campo requerido</div>
                        <hr class="border-top-0 border-bottom my-4">

                        <div class="row pb-3" *ngIf="formPedido.value.metodoenvio=='Olva courier'">

                          <div class="col-sm-12 mb-4">
                              <label for="ch-fn" class="form-label-lg">Dirección de envio</label>
                              <input type="text" class="form-control form-control-lg" id="ch-fn"
                                  placeholder="Ingresa tu dirección." formControlName="direccionEnvio">
                          </div>

                          <div class="col-sm-12 mb-4">
                            <label for="ch-fn" class="form-label-lg">Departamento</label>

                            <select class="form-select"  formControlName="dep" (ngModelChange)="getProvincia()" placeholder="---seleccione departamento---">
                              <option [value]="d.path" *ngFor="let d of departamento">{{d.name}}</option>
                          </select>                           
                        </div>

                        <div class="col-sm-12 mb-4">
                          <label for="ch-fn" class="form-label-lg">Provincia</label>
                          <select class="form-select"  formControlName="prov" (ngModelChange)="getDistrito()" placeholder="---seleccione provincia---">
                            <option [value]="p.path" *ngFor="let p of provincia">{{p.name}}</option>
                        </select>
                      </div>

                      <div class="col-sm-12 mb-4">
                        <label for="ch-fn" class="form-label-lg">Distrito</label> 
                        <select class="form-select"  formControlName="dist" placeholder="---seleccione distrito---" >
                          <option [value]="d.path" *ngFor="let d of distrito">{{d.name}}</option>
                      </select>
                    </div>
      
                          <div class="col-sm-12 mb-4">
                              <label for="ch-notes" class="form-label-lg">Referencia de envio</label>
                              <textarea id="ch-notes" class="form-control form-control-lg" rows="5"
                                  placeholder="Ingresa alguna referencia de tu dirección."
                                  formControlName="referenciaEnvio"></textarea>
                          </div>
                        </div>      
                        
                        


                        <div class="row pb-3" *ngIf="formPedido.value.metodoenvio=='Contra entrega'">

                          <div class="col-sm-12 mb-4">
                              <label for="ch-fn" class="form-label-lg">Punto de entrega</label>
                              <select class="form-select"  formControlName="direccionEnvio" (change)="onChange()">
                                <option [value]="p.value" *ngFor="let p of puntos">{{p.value}}</option>
                            </select> 
                          </div>

                          <div class="col-sm-12 mb-4">
                            <label for="ch-fn" class="form-label-lg">Horario</label>
                            <input type="text" class="form-control form-control-lg" id="ch-fn"
                            placeholder="{{referencia}}" formControlName="referenciaEnvio"  readonly>
                        </div>

                          <div class="col-sm-12 mb-4"*ngIf="xEstacion">
                            <label for="ch-fn" class="form-label-lg">Indicar estación</label>
                            <input type="text" class="form-control form-control-lg" id="ch-fn"
                                placeholder="Ingresa estación." formControlName="estacion">
                        </div>
                          
                        </div>  
                        
                        <label class="mt-sm-1 mb-sm-4 form-label-lg" for="ch-notes" class="">Método de pago</label>
                        <h4>Pago</h4>
                        <div class="simplebar-content" style="padding: 0px 0px 16px;text-align: center;">
                          <a class="d-inline-block mb-3 me-xl-4 me-3">
                            <input type="radio" value="Transferencia bancaria" class="form-check-input me-sm-2" formControlName="metodoPago">
                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTmBcovW6siCL89YgIWT3TCnWgt9eVwC0RN6czXwCVDRlFf74nfWKqIjSae9X9CBZQZ5gA&usqp=CAU" 
                            class="border rounded" style="width: 120px;">
                            <label class="d-inline-block mb-3 mx-sm-4">Transferencia bancaria</label>                
                          </a>
                          <a class="d-inline-block mb-3 me-xl-4 me-3">
                            <input type="radio" value="Yape" class="form-check-input me-sm-2" formControlName="metodoPago">
                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ8DI6OB4ly_tRrOsY5SlQZwGxDogJUhXWVRNGfnHq5joGCFc2gMjCQbR_kOd_LFebg66s&usqp=CAU" 
                            class="border rounded" style="width: 120px;"> 
                            <label class="d-inline-block mb-3 mx-sm-4">Yape</label>                          
                          </a>
                          <a class="d-inline-block mb-3">
                            <input type="radio" value="Plin" class="form-check-input me-sm-2" formControlName="metodoPago">
                            <img src="https://www.canadaperu.org/sites/default/files/styles/1024x576/public/store/noticias/img/2021-07/PLIN.png?itok=Q-aOJibG" 
                            class="border rounded" style="width: 120px;">   
                            <label class="d-inline-block mb-3 mx-sm-4">Plin</label>                         
                          </a>
                        </div>
                        <div *ngIf="formPedido.controls['metodoPago'].hasError('required')"
                        class="text-danger mt-2">*Campo requerido</div>

                        <div *ngIf="metodoPago(formPedido.value.metodoPago)" class="text-heading mt-2" style="text-align:center;">
                              <strong>{{cuentaMetodo}}</strong> 
                        </div>
            </form>
        </div>
        <!-- </form> -->
        <!-- Checkout -->

        <!-- Order totals (sticky sidebar) -->
        <aside class="col-lg-5">
            <div class="position-sticky">
                <div class="bg-secondary rounded mb-4">

                    <div class="border-bottom p-4">
                        <h2 class="h4 mb-0">Resumen de compra</h2>
                    </div>

                    <ul class="list-unstyled  mb-0 p-4">
                        <div *ngFor="let carrito of lCarrito"
                            class="d-flex align-items-start px-2 px-sm-4 py-4 border-bottom">

                            <a style="min-width: 80px;">
                                <img [src]="carrito.p_imagen" width="80" alt="Product thumb">
                            </a>

                            <div class="w-100 ps-3">
                                <div class="d-sm-flex">

                                    <div class="pe-sm-3 w-100" style="max-width: 16rem;">
                                        <h3 class="fs-sm mb-3">
                                            <a class="nav-link fw-bold">{{carrito.p_nombre}}</a>
                                        </h3>

                                        <ul class="list-unstyled fs-xs mt-n2 mb-2">
                                            <li class="mb-0"><span class="text-muted">Categoría:</span> {{carrito.cP_categoria}}
                                            </li>
                                            <li class="mb-0"><span class="text-muted">Cantidad:</span> {{carrito.cantidad}}</li>
                                        </ul>
                                    </div>

                                    <div class="text-end align-items-start w-100">

                                        <div class="text-nowrap pt-2">
                                            <strong class="text-danger">S/.{{carrito.cA_precioVenta | number : '1.2-2'}}
                                            </strong>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </ul>

                    <ul class="list-unstyled border-bottom mb-0 p-4">

                        <li class="d-flex justify-content-between mb-2">
                            <span class="fw-bold">Subtotal:</span>
                            <span class="fw-bold">S/. {{getSubTotal() | number : '1.2-2'}}</span>
                        </li>

                        <li class="d-flex justify-content-between mb-2">
                            <span>Montos agregados:</span>
                            <span>S/. {{adicionalPago(formPedido.value.metodoenvio)}}</span>
                        </li>

                    </ul>

                    <div class="d-flex justify-content-between p-4">
                        <span class="h5 mb-0">Monto total:</span>
                        <span class="h5 mb-0">S/. {{getSubTotal() + formPedido.value.adicional | number : '1.2-2'}}</span>
                    </div>
                </div>

                <button type="button" class="btn btn-primary btn-lg d-block w-100" (click)="registrarPedido()">Completar
                    Pedido</button>

            </div>
        </aside>
    </div>
</section>

<!-- Accordion -->
